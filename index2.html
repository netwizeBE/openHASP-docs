<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>openHASP Web installer</title>
    <meta
      name="description"
      content="Easily allow users to install openHASP firmware on the web."
    />
    <meta name="viewport" content="width=device-width" />
    <meta name="color-scheme" content="dark light" />
    <style>
      body {
        font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI",
          Roboto, Ubuntu, sans-serif;
        padding: 0;
        margin: 0;
        line-height: 1.4;
      }
      .content {
        max-width: 600px;
        margin: 0 auto;
        padding: 12px;
      }
      h2 {
        margin-top: 2em;
      }
      h3 {
        margin-top: 1.5em;
      }
      a {
        color: #03a9f4;
      }
      .invisible {
        visibility: hidden;
      }
      .hidden {
        display: none;
      }
      esp-web-install-button[install-unsupported] {
        visibility: inherit;
      }
      .content pre {
        max-width: 100%;
        overflow-y: scroll;
      }
      .footer {
        margin-top: 24px;
        border-top: 1px solid #ccc;
        padding-top: 24px;
        text-align: center;
      }
      .footer .initiative {
        font-style: italic;
        margin-top: 16px;
      }
      table {
        border-spacing: 0;
      }
      td {
        padding: 8px;
        border-bottom: 1px solid #ccc;
      }
      .radios li {
        list-style: none;
        line-height: 2em;
      }
      @media (prefers-color-scheme: dark) {
        body {
          background-color: #333;
          color: #fff;
        }
        a {
          color: #58a6ff;
        }
      }
    </style>
    <script type="module" src="https://unpkg.com/esp-web-tools@8.0.1/dist/web/install-button.js?module"></script>
  </head>
  <body>
    <div class="content">
      <h1>openHASP Web installer</h1>

      <div>
        <p>Select the manufacturer:</p>
        <ul class="radios">
            <li>
            <label><input type="radio" name="device" value="adafruit" /> Adafruit</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="az-touch" /> AZ-Touch</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="dustin-watts" /> Dustin Watts</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="lanbon-l8" /> Lanbon</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="lolin" /> Lolin</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="lilygo" /> LilyGo</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="ttgo" /> TTGO</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="m5stack" /> M5Stack</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="makerfabs" /> Makerfabs</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="unoshield" /> Unoshield</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="waveshare" /> Waveshare</label>
            </li>
            <li>
            <label><input type="radio" name="device" value="wireless-tag" /> Wireless-Tag</label>
            </li>
        </ul>
    </div>

    <span id="m5stack" class="model az-touch dustin-watts lanbon-l8 lilygo m5stack wireless-tag" style="display:none">
        <p>Pick your model:</p>
        <ul class="radios">
            <li class="model dustin-watts">
            <label><input type="radio" name="model" value="i2s" onChange="module('touchdown')" /> ESP32 TouchDown</label>
            </li>
            <li class="model dustin-watts">
            <label><input type="radio" name="model" value="muse" onChange="module('freetouchdeck')" /> FreeTouchDeck</label>
            </li>
            <li class="model m5stack">
            <label><input type="radio" name="model" value="i2s" /> M5Stack Core2</label>
            </li>
            <li class="model m5stack">
            <label><input type="radio" name="model" value="muse" /> M5Stack Tough</label>
            </li>
            <li class="model az-touch">
            <label><input type="radio" name="model" value="muse"  onChange="module('az-touch-mod')" /> AZ-Touch MOD</label>
            </li>
            <li class="model az-touch">
            <label><input type="radio" name="model" value="muse"  onChange="module('az-touch-feather')" /> AZ-Touch Feather</label>
            </li>
            <li class="model lanbon-l8">
            <label><input type="radio" name="model" value="i2s" onChange="display('lanbon-l8')" /> Lanbon L8</label>
            </li>
            <li class="model lilygo">
            <label><input type="radio" name="model" value="i2s" onChange="display('lilypi')" /> LilyPi</label>
            </li>
            <li class="model wireless-tag">
                <label><input type="radio" name="model" value="i2s" onChange="flash('wt32-sc01')" /> WT32-SC01</label>
            </li>
            <li class="model wireless-tag">
            <label><input type="radio" name="model" value="i2s" onChange="flash('wt86-32-3zw1')" /> WT86-32-3ZW1</label>
            </li>
        </ul>
    </span>

    <span ba="az-touch" class="module adafruit az-touch-mod az-touch-feather feather freetouchdeck lolin lolin24 rpi ttgo unoshield waveshare" style="display:none">
        <p>Choose your ESP Module:</p>
        <ul class="radios">
          <li class="module unoshield waveshare">
            <label><input type="radio" name="module" value="i2s" onChange="display('unoshield')"/> D1 R32 ESPduino</label>
            </li>
            <li class="module unoshield waveshare">
            <label><input type="radio" name="module" value="i2s" onChange="display('unoshield')"/> Arducam IoTai ESP32</label>
            </li>

            <li class="module az-touch-mod freetouchdeck">
            <label><input type="radio" name="module" value="i2s" onChange="flash('devkitc-v1')"/> ESP32-DevKit V1 (WROOM32) 38-pin</label>
            </li>
            <li class="module az-touch-mod freetouchdeck">
            <label><input type="radio" name="module" value="i2s" onChange="flash('devkitc-v4')"/> ESP32-DevKit V4 (WROOM32) 38-pin</label>
            </li>
            <li class="module az-touch-mod freetouchdeck">
            <label><input type="radio" name="module" value="i2s"  onChange="flash('devkitc-ve')" /> ESP32-DevKit VE (WROVER32) 38-pin</label>
            </li>

            <li class="module adafruit az-touch-feather feather">
                <label><input type="radio" name="module" value="i2s" onChange="display('feather')" /> <a href="https://www.adafruit.com/product/3405">Huzzah32</a></label>
            </li>    

            <li class="module waveshare rpi esp32-one">
                <label><input type="radio" name="module" value="i2s" onChange="display('rpi')" /> ESP32 One</label>
            </li> 

            <li class="module lolin lolin24 esp32-d1-mini">
                <label><input type="radio" name="module" value="i2s" onChange="display('d1-mini32')" /> ESP32 D1-mini</label>
            </li>
            <li class="module lolin lolin24 lolin-d32-pro">
              <label><input type="radio" name="module" value="i2s" onChange="display('lolin-d32-pro')" /> Lolin D32 Pro v2</label>
            </li>
            <li class="module lolin lolin24 ttgo ttgo-t7">
                <label><input type="radio" name="module" value="i2s" onChange="display('ttgo-t7')" /> TTGO T7 v1.4</label>
            </li>
            <li class="module lolin lolin24 ttgo ttgo-t7">
                <label><input type="radio" name="module" value="i2s" onChange="display('ttgo-t7')" /> TTGO T7 v1.5</label>
            </li>
        </ul>
      </span>


      <span class="display adafruit d1-mini32 feather huzzah32 lilypi lolin lolin-d32-pro rpi ttgo-t7 unoshield waveshare" style="display:none">
        <p>Pick your display:</p>
        <ul class="radios">
            <li class="display d1-mini32 lolin lolin24 lolin-d32-pro ttgo-t7">
            <label><input type="radio" name="display" value="i2s" onChange="module('lolin24')" /> Lolin TFT 2.4"</label>
            </li>
            
            <li class="display adafruit feather huzzah32">
            <label><input type="radio" name="display" value="i2s" /> AZ-Touch Feather</label>
            </li>

            <li class="display adafruit feather huzzah32">
            <label><input type="radio" name="display" value="i2s" /> Featherwing 2.4"</label>
            </li>
            <li class="display adafruit feather huzzah32">
            <label><input type="radio" name="display" value="i2s" /> Featherwing 3.5"</label>
            </li>   
            <li class="display lilypi">
            <label><input type="radio" name="display" value="i2s" /> LilyPi ILI9488</label>
            </li>   
            <li class="display lilypi">
            <label><input type="radio" name="display" value="i2s" /> LilyPi ST7789</label>
            </li>
            <li class="display waveshare unoshield">
            <label><input type="radio" name="display" value="i2s" onChange="module('unoshield')" /> Waveshare TFT Touch Shield 2.8" Rev 2.1</label>
            </li>
            <li class="display waveshare unoshield">
            <label><input type="radio" name="display" value="i2s" onChange="module('unoshield')" /> Waveshare TFT Touch Shield 3.5"</label>
            </li>
            <li class="display waveshare unoshield">
            <label><input type="radio" name="display" value="i2s" onChange="module('unoshield')" /> Waveshare TFT Touch Shield 4.0"</label>
            </li>
            <li class="display waveshare rpi esp32-one">
            <label><input type="radio" name="display" value="i2s" onChange="module('rpi')" /> Waveshare RPi LCD 3.5" Rev C</label>
            </li>
            <li class="display waveshare rpi esp32-one">
            <label><input type="radio" name="display" value="i2s" onChange="module('rpi')" /> Waveshare RPi LCD 4.0" Rev C</label>
            </li>
            </ul>
      </span>

      <span class="flash wt32-sc01 huzzah32 esp32-one devkitc-v1 devkitc-v4 devkitc-ve" style="display:none">
        <p>Flash size:</p>
        <ul class="radios">
            <li class="flash wt32-sc01 huzzah32 esp32-one devkitc-v1 devkitc-v4">
            <label><input type="radio" name="flash" value="4" /> 4 MB</label>
            </li>
            <li class="flash devkitc-ve lanbon-l8">
            <label><input type="radio" name="flash" value="8" /> 8 MB</label>
            </li>
            <li class="flash wt32-sc01">
            <label><input type="radio" name="flash" value="16" /> 16 MB</label>
            </li>
        </ul>
      </span>

      <p class="button-row" align="center">
        <esp-web-install-button class="invisible"></esp-web-install-button>
      </p>

      <div class="footer">
        <a href="https://openhasp.haswitchplate.com/0.6.3/"
          >openHASP</a
        > Web
        Installer powered by <a href="https://esphome.github.io/esp-web-tools/">ESP Web Tools</a>.
    </div>
    <script>
        function hide(name){}

        function sel(type, name){
            Array.from(document.getElementsByClassName(type)).forEach(span =>
                        span.style.display= 'none'
                    );
            Array.from(document.getElementsByClassName(type + " " + name)).forEach(span =>
                span.style.display= ''
            );

            document.querySelectorAll('li.'+type).forEach(li =>
                {
                    let label = li.firstElementChild;
                    let input = label.firstElementChild;
                    if (li.style.display == 'none') {
                        input.checked = !1;
                    } else {
                        if (input.checked) {


                           console.log(input);
                        }
                    }
                } 
            ); 
        }
        
        function model(name){
            sel("model",name)                   
        }

        function module(name){
            sel("module",name)                   
        }

        function display(name){
            sel("display",name)
        }

        function flash(name){
            sel("flash",name)
        }

        function show(name){
            model(name);
            module(name);
            display(name);
            flash(name);
        }

      document.querySelectorAll('input[name="device"]').forEach(radio =>
        radio.addEventListener("change", () => {
          const button = document.querySelector('esp-web-install-button');
          button.manifest = `./manifest_${radio.value}.json`;
          button.classList.remove('invisible');
        }
      ));
      document.querySelectorAll('input[name="device"]').forEach(radio =>
        radio.addEventListener("change", () => {
            show(radio.value)
        }
      ));
    </script>
  </body>
</html>